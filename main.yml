---
- name: Initial server configuration and hardening
  import_playbook: plays/setup.yml

- name: Setup production REIMS2
  import_playbook: plays/reims.yml
  vars:
    frontend_domain: "{{ inventory_hostname }}"
    db_name: "reims2-db"
    dokku_network_name: "reims2"
    frontend_app_name: "frontend"
    api_app_name: "api"
    docs_app_name: "docs"
    backend_jwt_token: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      63626362646532353035376538656531656661353839663634636433376432303161653335333937
      6437656262643939303232666535666562623063636262380a346161383131356664616561313061
      35346364326262653438343761373136316534313636393938393166346636333639306465313434
      6133383639626563350a636538623631343565353363346161613234383664306364383035663230
      3536
    aws_secret_key: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      38613833363963336663666163333238316230353264326633393931623666643763306638373239
      6130626132353536623934336663363265396234363464650a356137346437653263326366376131
      65333566623039386265636461623566396439306137383934333937633564613565643865346233
      3835303464306665340a373534306234383037383364383030326362643230653664353435316263
      31333361306337656631363966663562363064346631663764396466386439363062666466616531
      3632623962663634393736366564656236663332303430646162
    aws_bucket_name: reims2-backup
    db_dump: "{{ lookup('file', '../dump.sql', errors='warn') }}"

- name: Setup dev REIMS2
  import_playbook: plays/reims.yml
  vars:
    frontend_domain: "{{ 'dev.' + inventory_hostname }}"
    db_name: "dev-db"
    dokku_network_name: "dev-reims2"
    frontend_app_name: "dev-frontend"
    api_app_name: "dev-api"
    docs_app_name: "dev-docs"
    backend_jwt_token: "testtokentesttokentesttokentesttokentesttokentesttokentesttokentesttokentesttokentesttokentesttokentesttokentesttoken"
    debug_enable: True
    db_dump: "{{ lookup('file', '../dump.sql', errors='warn') }}"
